(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[871],{3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return g},kt:function(){return s}});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=r.createContext({}),c=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},g=function(e){var n=c(e.components);return r.createElement(p.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,g=i(e,["components","mdxType","originalType","parentName"]),m=c(t),s=a,u=m["".concat(p,".").concat(s)]||m[s]||d[s]||o;return t?r.createElement(u,l(l({ref:n},g),{},{components:t})):r.createElement(u,l({ref:n},g))}));function s(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,l=new Array(o);l[0]=m;var i={};for(var p in n)hasOwnProperty.call(n,p)&&(i[p]=n[p]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var c=2;c<o;c++)l[c]=t[c];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},7443:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return i},metadata:function(){return p},toc:function(){return c},default:function(){return d}});var r=t(2122),a=t(9756),o=(t(7294),t(3905)),l={},i="\u5750\u6807\u7a7a\u95f4",p={unversionedId:"coordinate-space",id:"coordinate-space",isDocsHomePage:!1,title:"\u5750\u6807\u7a7a\u95f4",description:"\u6211\u4eec\u524d\u9762\u5b66\u5230\u4e86\u5404\u79cd\u53d8\u6362\u77e9\u9635\u7528\u6765\u53d8\u6362\u7269\u4f53\uff0c\u76f8\u673a\u4ece\u67d0\u4e2a\u4f4d\u7f6e\u6765\u89c2\u770b\u573a\u666f\uff0c\u6295\u5f71\u77e9\u9635\u5c06\u573a\u666f\u8f6c\u6362\u5230 NDC\u3002\u6211\u4eec\u6bcf\u5c06\u7269\u4f53\u9876\u70b9\u5e94\u7528\u4e00\u4e2a\u77e9\u9635\u5176\u5b9e\u90fd\u662f\u5c06\u7269\u4f53\u8f6c\u6362\u5230\u77e9\u9635\u7684\u7a7a\u95f4\uff0c\u77e9\u9635\u7684 3 \u5217\u662f\u65b0\u5750\u6807\u7a7a\u95f4\u7684\u57fa\u77e2\u91cf\u3002\u6e32\u67d3\u4e00\u4e2a\u573a\u666f\u6211\u4eec\u4e00\u822c\u4f1a\u4f7f\u7528 3 \u4e2a\u77e9\u9635\u5c06\u573a\u666f\u8f6c\u6362\u5230 3 \u4e2a\u5750\u6807\u7a7a\u95f4\uff0c\u8fd9\u51e0\u4e2a\u6b65\u9aa4\u662f\u5206\u6b65\u8fdb\u884c\u5c31\u548c\u6d41\u6c34\u7ebf\u4e00\u6837\u3002",source:"@site/docs/10-coordinate-space.md",sourceDirName:".",slug:"/coordinate-space",permalink:"/learn-webgl/docs/coordinate-space",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/10-coordinate-space.md",version:"current",sidebarPosition:10,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u6295\u5f71\u77e9\u9635",permalink:"/learn-webgl/docs/projection"},next:{title:"\u9010\u91c7\u6837\u5904\u7406",permalink:"/learn-webgl/docs/pre-sample"}},c=[{value:"\u5bf9\u8c61\u7a7a\u95f4",id:"\u5bf9\u8c61\u7a7a\u95f4",children:[]},{value:"\u4e16\u754c\u7a7a\u95f4",id:"\u4e16\u754c\u7a7a\u95f4",children:[]},{value:"\u76f8\u673a\u7a7a\u95f4",id:"\u76f8\u673a\u7a7a\u95f4",children:[]},{value:"\u88c1\u526a\u7a7a\u95f4",id:"\u88c1\u526a\u7a7a\u95f4",children:[]},{value:"NDC \u7a7a\u95f4",id:"ndc-\u7a7a\u95f4",children:[]},{value:"\u6e32\u67d3\u7ba1\u7ebf",id:"\u6e32\u67d3\u7ba1\u7ebf",children:[]},{value:"gl_FragCoord",id:"gl_fragcoord",children:[]},{value:"\u6e32\u67d3\u591a\u4e2a\u7acb\u65b9\u4f53",id:"\u6e32\u67d3\u591a\u4e2a\u7acb\u65b9\u4f53",children:[]}],g={toc:c};function d(e){var n=e.components,t=(0,a.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,r.Z)({},g,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"\u5750\u6807\u7a7a\u95f4"},"\u5750\u6807\u7a7a\u95f4"),(0,o.kt)("p",null,"\u6211\u4eec\u524d\u9762\u5b66\u5230\u4e86\u5404\u79cd\u53d8\u6362\u77e9\u9635\u7528\u6765\u53d8\u6362\u7269\u4f53\uff0c\u76f8\u673a\u4ece\u67d0\u4e2a\u4f4d\u7f6e\u6765\u89c2\u770b\u573a\u666f\uff0c\u6295\u5f71\u77e9\u9635\u5c06\u573a\u666f\u8f6c\u6362\u5230 NDC\u3002\u6211\u4eec\u6bcf\u5c06\u7269\u4f53\u9876\u70b9\u5e94\u7528\u4e00\u4e2a\u77e9\u9635\u5176\u5b9e\u90fd\u662f\u5c06\u7269\u4f53\u8f6c\u6362\u5230\u77e9\u9635\u7684\u7a7a\u95f4\uff0c\u77e9\u9635\u7684 3 \u5217\u662f\u65b0\u5750\u6807\u7a7a\u95f4\u7684\u57fa\u77e2\u91cf\u3002\u6e32\u67d3\u4e00\u4e2a\u573a\u666f\u6211\u4eec\u4e00\u822c\u4f1a\u4f7f\u7528 3 \u4e2a\u77e9\u9635\u5c06\u573a\u666f\u8f6c\u6362\u5230 3 \u4e2a\u5750\u6807\u7a7a\u95f4\uff0c\u8fd9\u51e0\u4e2a\u6b65\u9aa4\u662f\u5206\u6b65\u8fdb\u884c\u5c31\u548c\u6d41\u6c34\u7ebf\u4e00\u6837\u3002"),(0,o.kt)("img",{src:"https://user-images.githubusercontent.com/25923128/123030144-df8e2000-d414-11eb-8e1f-4d14e7433dd6.png",width:"300"}),(0,o.kt)("p",null,"\u7269\u4f53\u6700\u521d\u662f\u5728\u5bf9\u8c61\u7a7a\u95f4\uff0c\u7ecf\u8fc7\u6a21\u578b\u53d8\u6362\uff08Model Transform\uff09\u5c06\u7269\u4f53\u8f6c\u6362\u5230\u4e16\u754c\u7a7a\u95f4\uff0c\u5728\u4e16\u754c\u7a7a\u95f4\u4e2d\u7ecf\u8fc7\u89c6\u56fe\u53d8\u6362\uff08View Transform\uff09\u8f6c\u6362\u6210\u76f8\u673a\u7a7a\u95f4\uff08\u6216\u773c\u7a7a\u95f4\uff09\u6700\u540e\u901a\u8fc7\u6295\u5f71\u53d8\u6362\uff08Projection Transform\uff09\u53d8\u6362\u5230\u88c1\u5207\u7a7a\u95f4\u3002\u8fd9\u51e0\u6b21\u53d8\u6362\u7b80\u79f0\u4e3a MVP \u53d8\u6362\uff0c\u4e00\u822c\u6bcf\u4e2a\u7269\u4f53\u5728\u6e32\u67d3\u4e4b\u524d\u90fd\u4f1a\u8fdb\u884c\u8fd9 3 \u6b21\u53d8\u6362\u3002"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/25923128/122650168-ef330d80-d163-11eb-94d0-ee2270f5ca48.png",alt:"image"})),(0,o.kt)("h2",{id:"\u5bf9\u8c61\u7a7a\u95f4"},"\u5bf9\u8c61\u7a7a\u95f4"),(0,o.kt)("p",null,"\u5bf9\u8c61\u7a7a\u95f4\u4e5f\u79f0\u4e3a\u5c40\u90e8\u7a7a\u95f4\uff0c\u5236\u4f5c 3D \u6a21\u578b\u65f6\u6211\u4eec\u5e76\u4e0d\u77e5\u9053\u8fd9\u4e2a\u6a21\u578b\u6700\u7ec8\u5728\u573a\u666f\u4e2d\u7684\u4f4d\u7f6e\uff0c\u4e00\u822c\u5c06\u6a21\u578b\u653e\u5728\u5750\u6807\u8f74\u7684\u6b63\u4e2d\u95f4\uff0c\u5c31\u50cf\u6211\u4eec\u4e4b\u524d\u624b\u5199\u5c01\u88c5\u7684\u76d2\u5b50\uff0c\u6211\u4eec\u4e5f\u5c06\u5b83\u7684\u4e2d\u5fc3\u653e\u5230\u5750\u6807\u8f74\u7684\u6b63\u4e2d\u5fc3\u3002"),(0,o.kt)("h2",{id:"\u4e16\u754c\u7a7a\u95f4"},"\u4e16\u754c\u7a7a\u95f4"),(0,o.kt)("p",null,"\u4e16\u754c\u7a7a\u95f4\u5c31\u662f\u6211\u4eec\u6e32\u67d3\u7684\u4e00\u4e2a\u573a\u666f\uff0c\u6240\u6709\u6a21\u578b\u90fd\u5728\u8fd9\u4e2a\u7a7a\u95f4\uff0c\u8fd9\u4e9b\u6a21\u578b\u9ed8\u8ba4\u90fd\u5728\u5bf9\u8c61\u7a7a\u95f4\u4e5f\u5c31\u662f\u5168\u90e8\u90fd\u5728\u5750\u6807\u539f\u70b9\u3002\u6211\u4eec\u9700\u8981\u4f7f\u7528",(0,o.kt)("strong",{parentName:"p"},"\u6a21\u578b\u53d8\u6362"),"\u5206\u522b\u5c06\u8fd9\u4e2a\u6a21\u578b\u53d8\u6362\u5230\u5b83\u5e94\u8be5\u5728\u7684\u4f4d\u7f6e\u3002\u6bd4\u5982\u4e00\u4e2a\u98de\u673a\u6a21\u578b\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6a21\u578b\u53d8\u6362\u5c06\u5b83\u53d8\u6362\u5230\u4e16\u754c\u5750\u6807\u7684\u7a7a\u4e2d\u4f4d\u7f6e\u3002\u6216\u8005\u4e00\u4e2a\u6a21\u578b\u592a\u5927\u4e86\uff0c\u6211\u4eec\u4f7f\u7528",(0,o.kt)("strong",{parentName:"p"},"\u6a21\u578b\u53d8\u6362"),"\u5c06\u5b83\u7f29\u5c0f\u3002\u5728\u6a21\u578b\u53d8\u6362\u540e\uff0c\u6211\u4eec\u5c31\u5c06\u8fd9\u4e9b\u6a21\u578b\u4ece\u539f\u70b9\u53d8\u6362\u5230\u5b83\u4eec\u5e94\u8be5\u5728\u7684\u4f4d\u7f6e\u5e76\u4e14\u662f\u5408\u9002\u7684\u5927\u5c0f\u548c\u65cb\u8f6c\u89d2\u5ea6\u3002"),(0,o.kt)("h2",{id:"\u76f8\u673a\u7a7a\u95f4"},"\u76f8\u673a\u7a7a\u95f4"),(0,o.kt)("p",null,"\u76f8\u673a\u7a7a\u95f4\u4e5f\u79f0\u89c2\u5bdf\u7a7a\u95f4\u662f\u4ece\u76f8\u673a\u7684\u89c6\u89d2\u6240\u89c2\u5bdf\u5230\u7684\u7a7a\u95f4\uff0c\u5c06\u6a21\u578b\u90fd\u653e\u5728\u4e86\u5408\u9002\u7684\u4f4d\u7f6e\u540e\uff0c\u6211\u4eec\u5c31\u9700\u8981\u4ee5\u4e00\u4e2a\u89d2\u5ea6\u53bb\u89c2\u5bdf\u8fd9\u4e2a\u573a\u666f\uff0c\u901a\u8fc7",(0,o.kt)("strong",{parentName:"p"},"\u89c6\u56fe\u53d8\u6362"),"\u5c06\u4e16\u754c\u7a7a\u95f4\u53d8\u6362\u5230\u76f8\u673a\u7a7a\u95f4\u3002"),(0,o.kt)("h2",{id:"\u88c1\u526a\u7a7a\u95f4"},"\u88c1\u526a\u7a7a\u95f4"),(0,o.kt)("p",null,"OpenGL \u53ea\u4f1a\u5c06 XYZ \u8f74 -1 \u548c 1 \u4e4b\u95f4\u7269\u4f53\u6e32\u67d3\u5230\u5c4f\u5e55\uff0c\u8fd9\u4e2a\u8303\u56f4\u4e4b\u5916\u7684\u70b9\u90fd\u5e94\u8be5\u88ab\u88c1\u526a\u6389\u3002\u5728\u8f6c\u6362\u5230\u76f8\u673a\u7a7a\u95f4\u540e\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u4f7f\u7528",(0,o.kt)("strong",{parentName:"p"},"\u6295\u5f71\u77e9\u9635"),"\u5c06\u76f8\u673a\u7a7a\u95f4\u8f6c\u6362\u5230\u8fd9\u4e2a\u89c4\u5219\u89c2\u5bdf\u4f53\u7a7a\u95f4\uff0c\u7531\u6295\u5f71\u77e9\u9635\u521b\u5efa\u7684\u89c2\u5bdf\u7bb1\u88ab\u79f0\u4e3a\u5e73\u622a\u5934\u4f53(Frustum)\uff0c\u4e0d\u540c\u7684\u6295\u5f71\u77e9\u9635\u4f1a\u5f62\u6210\u4e0d\u540c\u7684\u5e73\u622a\u5934\u4f53\uff0c",(0,o.kt)("a",{parentName:"p",href:"/learn-webgl/docs/projection"},"\u4e0a\u7bc7\u6587\u7ae0"),"\u4e2d\uff0c\u6211\u4eec\u77e5\u9053\u6b63\u4ea4\u6295\u5f71\u662f\u4e00\u4e2a\u65b9\u65b9\u6b63\u6b63\u7684\u76d2\u5b50\uff0c\u900f\u89c6\u6295\u5f71\u662f\u56db\u89d2\u9525\u53f0\u3002\u4f7f\u7528",(0,o.kt)("strong",{parentName:"p"},"\u6295\u5f71\u77e9\u9635"),"\u8f6c\u6362\u5230\u88c1\u5207\u7a7a\u95f4\u540e\uff0cOpenGL \u4f1a\u5728\u9876\u70b9\u7740\u8272\u5668\u6267\u884c\u540e\uff0c\u81ea\u52a8\u6267\u884c\u9f50\u6b21\u9664\u6cd5\u5f97\u5230\u6bcf\u4e2a\u70b9\u7684\u5750\u6807\u3002"),(0,o.kt)("h2",{id:"ndc-\u7a7a\u95f4"},"NDC \u7a7a\u95f4"),(0,o.kt)("p",null,"\u5c06\u88c1\u526a\u7a7a\u95f4\u5750\u6807\u8d4b\u503c\u7ed9 ",(0,o.kt)("inlineCode",{parentName:"p"},"gl_Position")," \u540e\uff0cOpenGL \u4f1a\u81ea\u52a8\u6267\u884c\u900f\u89c6\u9664\u6cd5 ",(0,o.kt)("inlineCode",{parentName:"p"},"[Xc / Wc, Yc / Wc, Zc / Wc]"),"\uff0c\u5c06\u88c1\u526a\u7a7a\u95f4\u8f6c\u6362\u5230 NDC \u7a7a\u95f4\u3002"),(0,o.kt)("h2",{id:"\u6e32\u67d3\u7ba1\u7ebf"},"\u6e32\u67d3\u7ba1\u7ebf"),(0,o.kt)("p",null,"\u6211\u4eec\u73b0\u5728\u6765\u5c06\u8fd9\u4e9b\u6982\u5ff5\u5168\u90e8\u4e32\u8d77\u6765\uff0c\u4e00\u4e2a\u6a21\u578b\u6e32\u67d3\u5230\u663e\u793a\u5668\u4e0a\u4e00\u5171\u4f1a\u7ecf\u8fc7\u54ea\u4e9b\u6b65\u9aa4\u3002"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u63d0\u4f9b\u6a21\u578b\u9876\u70b9\u5750\u6807\u6570\u636e")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u8fd0\u884c\u9876\u70b9\u7740\u8272\u5668\uff0c\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u5bf9\u9010\u9876\u70b9\u8fdb\u884c\u5904\u7406\uff0c\u8fdb\u884c\u4e0a\u9762\u63d0\u5230\u7684 MVP \u53d8\u6362\u5230",(0,o.kt)("a",{parentName:"p",href:"/learn-webgl/docs/coordinate"},"\u6807\u51c6\u5316\u8bbe\u5907\u5750\u6807"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u9876\u70b9\u540e\u5904\u7406"),(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u56fe\u5143\u7ec4\u88c5\uff0c\u5c06\u4e00\u4e2a\u4e2a\u9876\u70b9\u7ec4\u88c5\u6210\u4e09\u89d2\u5f62\u6216\u7ebf\u7b49 OpenGL \u652f\u6301\u7684\u56fe\u5143")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("a",{parentName:"p",href:"/learn-webgl/docs/box"},"\u9762\u5254\u9664"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u5254\u9664\u5e73\u622a\u5934\u4f53\u5916\u7684\u56fe\u5143(",(0,o.kt)("inlineCode",{parentName:"p"},"-w <= x <= w; -w <= y <= w; -w <= z <= w"),")\uff0c\u4e0d\u540c\u56fe\u5143\u6709\u4e0d\u540c\u7684\u5904\u7406\u65b9\u5f0f\u3002\u5982\u679c\u4e09\u89d2\u5f62\u521a\u597d\u53ea\u6709\u4e00\u90e8\u5206\u5728\u5916\u9762\uff0c\u4f1a\u751f\u6210\u5728\u5185\u90e8\u7684\u9876\u70b9\uff0c\u5c06\u5916\u90e8\u7684\u90e8\u5206\u5254\u9664")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u900f\u89c6\u9664\u6cd5\uff0c\u4e0a\u9762\u63d0\u5230\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"[x / w, y / w, z / w]"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u89c6\u53e3\u53d8\u6362\uff0c\u5c06 NDC \u7a7a\u95f4\u8f6c\u6362\u5230\u7a97\u53e3\u7a7a\u95f4\uff0c\u6211\u901a\u8fc7 ",(0,o.kt)("inlineCode",{parentName:"p"},"gl.viewport(x, y, width, height)")," \u548c ",(0,o.kt)("inlineCode",{parentName:"p"},"gl.depthRange(near, far)")," \u6307\u5b9a\u7a97\u53e3\u76f8\u5173\u4fe1\u606f"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},"halfWidth = width / 2\nhalfHeight = height / 2\n\nXw = halfWidth * Xndc + x + halfWidth\nYw = halfHeight * Yndc + y + halfHeight\nZw = (far - near) / 2 * Zndc + (far + near) / 2 = Depth\n")),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"Zw")," \u662f\u5f53\u524d\u6df1\u5ea6\u503c")))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u5149\u6805\u5316\uff0c\u5c06\u6bcf\u4e2a\u5355\u72ec\u7684\u56fe\u5143\u5206\u89e3\u6210\u79bb\u6563\u7684\u7247\u6bb5\uff08\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a\u5c06 SVG \u53d8\u6210\u50cf\u7d20\u56fe\uff09\uff0c",(0,o.kt)("a",{parentName:"p",href:"/learn-webgl/docs/shader"},"varying"),"\u53c2\u6570\u63d2\u503c")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u8fd0\u884c\u7247\u6bb5\u7740\u8272\u5668\uff0c\u5904\u7406\u9010\u7247\u6bb5")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"\u9010\u91c7\u6837\u5904\u7406\uff08\u4e0b\u7bc7\u6587\u7ae0\u8be6\u7ec6\u8bb2\u89e3\uff09"))),(0,o.kt)("h2",{id:"gl_fragcoord"},"gl_FragCoord"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"/learn-webgl/docs/camera"},"\u524d\u9762\u7ae0\u8282"),"\u4e2d\uff0c\u6211\u4eec\u5728\u7247\u6bb5\u7740\u8272\u5668\u4e2d\u4f7f\u7528\u4e86 ",(0,o.kt)("inlineCode",{parentName:"p"},"gl_FragCoord"),"\u3002\u73b0\u5728\u5c31\u6765\u597d\u597d\u4e86\u89e3\u8fd9\u4e2a\u5b83\u5427\u3002"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"gl_FragCoord")," \u662f\u53ea\u8bfb\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"vec4")," \u7c7b\u578b\u53d8\u91cf\u3002\u6211\u4eec\u53ef\u4ee5\u5728\u7247\u6bb5\u7740\u8272\u5668\u4e2d\u8bbf\u95ee\u5b83\uff0c\u5b83\u5305\u542b\u5f53\u524d\u7247\u6bb5\u7a97\u53e3\u5750\u6807\u76f8\u5173\u7684\u4fe1\u606f\u3002",(0,o.kt)("inlineCode",{parentName:"p"},"gl_FragCoord.xyz")," \u5c31\u662f\u4e0a\u9762\u89c6\u53e3\u53d8\u6362\u4e2d\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"[Xw, Yw, Zw]"),"\u3002",(0,o.kt)("inlineCode",{parentName:"p"},"gl_FragCoord.w")," \u662f ",(0,o.kt)("inlineCode",{parentName:"p"},"1 / clip.w"),"\uff0c",(0,o.kt)("inlineCode",{parentName:"p"},"clip.w")," \u662f\u88c1\u526a\u7a7a\u95f4\u7684 W \u5206\u91cf\uff0c\u4e5f\u5c31\u662f ",(0,o.kt)("inlineCode",{parentName:"p"},"gl_Position.w"),"\u3002"),(0,o.kt)("p",null,"\u53ef\u4ee5\u901a\u8fc7 ",(0,o.kt)("inlineCode",{parentName:"p"},"gl_FragCoord")," \u8ba1\u7b97\u5f53\u524d\u7247\u6bb5\u5728\u5176\u4ed6\u7a7a\u95f4\u7684\u5750\u6807\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"ndcPos.xy = ((2.0 * gl_FragCoord.xy) - (2.0 * viewport.xy)) / (viewport.zw) - 1;\nndcPos.z = (2.0 * gl_FragCoord.z - gl_DepthRange.near - gl_DepthRange.far) /\n    (gl_DepthRange.far - gl_DepthRange.near);\nndcPos.w = 1.0;\n\nvec4 clipPos = ndcPos / gl_FragCoord.w;\nvec4 eyePos = projectionMatrixInverse * clipPos;\n")),(0,o.kt)("p",null,"\u6839\u636e\u4e0a\u9762\u89c6\u53e3\u53d8\u6362\u7684\u516c\u5f0f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u53cd\u63a8\u51fa\u6765 NDC \u7a7a\u95f4\u7684\u5750\u6807\u503c\uff0c\u7136\u540e\u624b\u52a8\u5c06 NDC \u4e58 ",(0,o.kt)("inlineCode",{parentName:"p"},"clip.w")," \u8f6c\u6362\u5230\u88c1\u526a\u7a7a\u95f4\uff0c\u518d\u901a\u8fc7\u9006\u6295\u5f71\u77e9\u9635\u8f6c\u6362\u5230\u773c\u7a7a\u95f4\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u63a5\u7740\u7528\u9006\u77e9\u9635\u8f6c\u6362\u5230\u4e16\u754c\u7a7a\u95f4\u3002"),(0,o.kt)("h2",{id:"\u6e32\u67d3\u591a\u4e2a\u7acb\u65b9\u4f53"},"\u6e32\u67d3\u591a\u4e2a\u7acb\u65b9\u4f53"),(0,o.kt)("p",null,"\u73b0\u5728\u8ba9\u6211\u4eec\u6765\u7528 MVP \u77e9\u9635\u6765\u6e32\u67d3\u591a\u4e2a\u7acb\u65b9\u4f53\u5427\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js",metastring:"{10} run","{10}":!0,run:!0},"const gl = createGl()\n\nconst program = createProgramFromSource(gl, `\nattribute vec4 position;\nuniform mat4 model;\nuniform mat4 view;\nuniform mat4 projection;\n\nvoid main() {\n  gl_Position = projection * view * model * position;\n}\n`, `\nprecision highp float;\n\nvoid main() {\n  gl_FragColor = vec4(gl_FragCoord.zzz, 1);\n}\n`)\n\nconst box = createBox()\n// { index: { value: [], size: 1 }, position: { value: [], size: 3 } }\n\nconst indexBuffer = gl.createBuffer()\ngl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer)\ngl.bufferData(gl.ELEMENT_ARRAY_BUFFER, box.index.value, gl.STATIC_DRAW)\n\nconst [posLoc] = createAttrBuffer(gl, program, 'position', box.position.value)\ngl.vertexAttribPointer(posLoc, 3, gl.FLOAT, false, 0, 0)\ngl.enableVertexAttribArray(posLoc)\n\nconst camera = new Camera()\ncamera.position.x = camera.position.y = 0\ncamera.position.z = 5\ncamera.lookAt([0, 0, 0])\nconst viewLoc = gl.getUniformLocation(program, 'view')\ngl.uniformMatrix4fv(viewLoc, false, camera.viewMatrix)\n\nconst perLoc = gl.getUniformLocation(program, 'projection')\ngl.uniformMatrix4fv(perLoc, false, Mat4.perspective(45 * Math.PI / 180, gl.canvas.clientWidth / gl.canvas.clientHeight, 1, 100))\n\nconst modelLoc = gl.getUniformLocation(program, 'model')\n\ngl.enable(gl.DEPTH_TEST)\ngl.enable(gl.CULL_FACE)\ngl.clearColor(0, 0, 0, 0)\n\nlet r = 0\nrender()\n\nfunction render() {\n  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT)\n  const rotation = Mat4.fromYRotation(r)\n\n  drawBox(-1, 1, 0, rotation)\n  drawBox(1, 1, 0, rotation)\n  drawBox(1, -1, 0, rotation)\n  drawBox(-1, -1, 0, rotation)\n  drawBox(0, 0, 1, rotation)\n  drawBox(0, 0, -1, rotation)\n\n  r += 0.01\n\n  requestAnimationFrame(render)\n}\n\nfunction drawBox(x, y, z, rotation) {\n  gl.uniformMatrix4fv(modelLoc, false, Mat4.multiply(rotation, Mat4.fromTranslation([x, y, z])))\n  gl.drawElements(gl.TRIANGLES, box.index.value.length, gl.UNSIGNED_SHORT, 0)\n}\n\nfunction createShader(gl, type, source) {\n  const shader = gl.createShader(type)\n  gl.shaderSource(shader, source)\n  gl.compileShader(shader)\n  return shader;\n}\n\nfunction createProgramFromSource(gl, vertex, fragment) {\n  const vertexShader = createShader(gl, gl.VERTEX_SHADER,vertex)\n  const fragmentShader = createShader(gl, gl.FRAGMENT_SHADER, fragment)\n  const program = gl.createProgram()\n  gl.attachShader(program, vertexShader)\n  gl.attachShader(program, fragmentShader)\n  gl.linkProgram(program)\n  gl.useProgram(program)\n  return program\n}\n\nfunction createAttrBuffer(gl, program, attr, data) {\n  const location = gl.getAttribLocation(program, attr)\n  const buffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer)\n  gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW)\n  return [location, buffer]\n}\n")))}d.isMDXComponent=!0}}]);