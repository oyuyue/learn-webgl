<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.1">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">坐标空间 | Learn WebGL</title><meta data-react-helmet="true" property="og:url" content="https://woopen.github.io/learn-webgl/docs/coordinate-space"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="坐标空间 | Learn WebGL"><meta data-react-helmet="true" name="description" content="我们前面学到了各种变换矩阵用来变换物体，相机从某个位置来观看场景，投影矩阵将场景转换到 NDC。我们每将物体顶点应用一个矩阵其实都是将物体转换到矩阵的空间，矩阵的 3 列是新坐标空间的基矢量。渲染一个场景我们一般会使用 3 个矩阵将场景转换到 3 个坐标空间，这几个步骤是分步进行就和流水线一样。"><meta data-react-helmet="true" property="og:description" content="我们前面学到了各种变换矩阵用来变换物体，相机从某个位置来观看场景，投影矩阵将场景转换到 NDC。我们每将物体顶点应用一个矩阵其实都是将物体转换到矩阵的空间，矩阵的 3 列是新坐标空间的基矢量。渲染一个场景我们一般会使用 3 个矩阵将场景转换到 3 个坐标空间，这几个步骤是分步进行就和流水线一样。"><link data-react-helmet="true" rel="shortcut icon" href="/learn-webgl/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://woopen.github.io/learn-webgl/docs/coordinate-space"><link data-react-helmet="true" rel="alternate" href="https://woopen.github.io/learn-webgl/docs/coordinate-space" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://woopen.github.io/learn-webgl/docs/coordinate-space" hreflang="x-default"><link rel="stylesheet" href="/learn-webgl/assets/css/styles.9fc5e9f4.css">
<link rel="preload" href="/learn-webgl/assets/js/runtime~main.4016e30c.js" as="script">
<link rel="preload" href="/learn-webgl/assets/js/main.3b67555e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP shadow--md">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/learn-webgl/"><img src="/learn-webgl/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/learn-webgl/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Learn WebGL</b></a><a class="navbar__item navbar__link navbar__link--active" href="/learn-webgl/docs/intro">教程</a><a class="navbar__item navbar__link" href="/learn-webgl/examples">例子</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/woopen/learn-webgl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/learn-webgl/"><img src="/learn-webgl/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/learn-webgl/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Learn WebGL</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/learn-webgl/docs/intro">教程</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/examples">例子</a></li><li class="menu__list-item"><a href="https://github.com/woopen/learn-webgl" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo sidebarWithHideableNavbar_267A"><a tabindex="-1" class="sidebarLogo_3h0W" href="/learn-webgl/"><img src="/learn-webgl/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/learn-webgl/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m"><b>Learn WebGL</b></a><nav class="menu menu--responsive thin-scrollbar menu_Bmed" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/preface">前言</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/intro">介绍</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/coordinate">坐标系</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/vector-matrix">矢量和矩阵</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/taste">浅尝</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/shader">着色器 / GLSL</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/transform">变换</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/box">盒子 / 面剔除</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/camera">相机</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/projection">投影矩阵</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/learn-webgl/docs/coordinate-space">坐标空间</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/pre-sample">逐采样处理</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/refactor">代码重构</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/sphere">球</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/euler-angles">欧拉角和万向节死锁</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/quaternion">四元数</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/orbit">轨道控制器</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/texture">纹理</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/blinn-phong">Blinn-Phong 光照</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/framebuffer">帧缓存</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/lighting-maps">光照贴图</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/multiple-lights">多光源</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/visualizing-camera">可视化相机</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/shadow">阴影</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/rendering-pipeline">渲染管线</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/obj-loader">OBJ 模型加载</a></li><li class="menu__list-item"><a class="menu__link" href="/learn-webgl/docs/skybox">天空盒</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">坐标空间</h1></header><p>我们前面学到了各种变换矩阵用来变换物体，相机从某个位置来观看场景，投影矩阵将场景转换到 NDC。我们每将物体顶点应用一个矩阵其实都是将物体转换到矩阵的空间，矩阵的 3 列是新坐标空间的基矢量。渲染一个场景我们一般会使用 3 个矩阵将场景转换到 3 个坐标空间，这几个步骤是分步进行就和流水线一样。</p><img src="https://user-images.githubusercontent.com/25923128/123030144-df8e2000-d414-11eb-8e1f-4d14e7433dd6.png" width="300"><p>物体最初是在对象空间，经过模型变换（Model Transform）将物体转换到世界空间，在世界空间中经过视图变换（View Transform）转换成相机空间（或眼空间）最后通过投影变换（Projection Transform）变换到裁切空间。这几次变换简称为 MVP 变换，一般每个物体在渲染之前都会进行这 3 次变换。</p><p><img src="https://user-images.githubusercontent.com/25923128/122650168-ef330d80-d163-11eb-94d0-ee2270f5ca48.png" alt="image"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="对象空间"></a>对象空间<a class="hash-link" href="#对象空间" title="Direct link to heading">#</a></h2><p>对象空间也称为局部空间，制作 3D 模型时我们并不知道这个模型最终在场景中的位置，一般将模型放在坐标轴的正中间，就像我们之前手写封装的盒子，我们也将它的中心放到坐标轴的正中心。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="世界空间"></a>世界空间<a class="hash-link" href="#世界空间" title="Direct link to heading">#</a></h2><p>世界空间就是我们渲染的一个场景，所有模型都在这个空间，这些模型默认都在对象空间也就是全部都在坐标原点。我们需要使用<strong>模型变换</strong>分别将这个模型变换到它应该在的位置。比如一个飞机模型，我们可以使用模型变换将它变换到世界坐标的空中位置。或者一个模型太大了，我们使用<strong>模型变换</strong>将它缩小。在模型变换后，我们就将这些模型从原点变换到它们应该在的位置并且是合适的大小和旋转角度。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="相机空间"></a>相机空间<a class="hash-link" href="#相机空间" title="Direct link to heading">#</a></h2><p>相机空间也称观察空间是从相机的视角所观察到的空间，将模型都放在了合适的位置后，我们就需要以一个角度去观察这个场景，通过<strong>视图变换</strong>将世界空间变换到相机空间。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="裁剪空间"></a>裁剪空间<a class="hash-link" href="#裁剪空间" title="Direct link to heading">#</a></h2><p>OpenGL 只会将 XYZ 轴 -1 和 1 之间物体渲染到屏幕，这个范围之外的点都应该被裁剪掉。在转换到相机空间后，我们还需要使用<strong>投影矩阵</strong>将相机空间转换到这个规则观察体空间，由投影矩阵创建的观察箱被称为平截头体(Frustum)，不同的投影矩阵会形成不同的平截头体，<a href="/learn-webgl/docs/projection">上篇文章</a>中，我们知道正交投影是一个方方正正的盒子，透视投影是四角锥台。使用<strong>投影矩阵</strong>转换到裁切空间后，OpenGL 会在顶点着色器执行后，自动执行齐次除法得到每个点的坐标。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="ndc-空间"></a>NDC 空间<a class="hash-link" href="#ndc-空间" title="Direct link to heading">#</a></h2><p>将裁剪空间坐标赋值给 <code>gl_Position</code> 后，OpenGL 会自动执行透视除法 <code>[Xc / Wc, Yc / Wc, Zc / Wc]</code>，将裁剪空间转换到 NDC 空间。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="渲染管线"></a>渲染管线<a class="hash-link" href="#渲染管线" title="Direct link to heading">#</a></h2><p>我们现在来将这些概念全部串起来，一个模型渲染到显示器上一共会经过哪些步骤。</p><ol><li><p>提供模型顶点坐标数据</p></li><li><p>运行顶点着色器，在顶点着色器中对逐顶点进行处理，进行上面提到的 MVP 变换到<a href="/learn-webgl/docs/coordinate">标准化设备坐标</a></p></li><li><p>顶点后处理</p><ol><li><p>图元组装，将一个个顶点组装成三角形或线等 OpenGL 支持的图元</p></li><li><p><a href="/learn-webgl/docs/box">面剔除</a></p></li><li><p>剔除平截头体外的图元(<code>-w &lt;= x &lt;= w; -w &lt;= y &lt;= w; -w &lt;= z &lt;= w</code>)，不同图元有不同的处理方式。如果三角形刚好只有一部分在外面，会生成在内部的顶点，将外部的部分剔除</p></li><li><p>透视除法，上面提到的 <code>[x / w, y / w, z / w]</code></p></li><li><p>视口变换，将 NDC 空间转换到窗口空间，我通过 <code>gl.viewport(x, y, width, height)</code> 和 <code>gl.depthRange(near, far)</code> 指定窗口相关信息</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">halfWidth </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> width </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">halfHeight </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> height </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token maybe-class-name">Xw</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> halfWidth </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token maybe-class-name">Xndc</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> halfWidth</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token maybe-class-name">Yw</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> halfHeight </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token maybe-class-name">Yndc</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> y </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> halfHeight</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token maybe-class-name">Zw</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">far </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> near</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token maybe-class-name">Zndc</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">far </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> near</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token maybe-class-name">Depth</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>Zw</code> 是当前深度值</p></li></ol></li><li><p>光栅化，将每个单独的图元分解成离散的片段（可以简单理解为将 SVG 变成像素图），<a href="/learn-webgl/docs/shader">varying</a>参数插值</p></li><li><p>运行片段着色器，处理逐片段</p></li><li><p>逐采样处理（下篇文章详细讲解）</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="gl_fragcoord"></a>gl_FragCoord<a class="hash-link" href="#gl_fragcoord" title="Direct link to heading">#</a></h2><p><a href="/learn-webgl/docs/camera">前面章节</a>中，我们在片段着色器中使用了 <code>gl_FragCoord</code>。现在就来好好了解这个它吧。</p><p><code>gl_FragCoord</code> 是只读的 <code>vec4</code> 类型变量。我们可以在片段着色器中访问它，它包含当前片段窗口坐标相关的信息。<code>gl_FragCoord.xyz</code> 就是上面视口变换中的 <code>[Xw, Yw, Zw]</code>。<code>gl_FragCoord.w</code> 是 <code>1 / clip.w</code>，<code>clip.w</code> 是裁剪空间的 W 分量，也就是 <code>gl_Position.w</code>。</p><p>可以通过 <code>gl_FragCoord</code> 计算当前片段在其他空间的坐标。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ndcPos</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">xy</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">2.0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> gl_FragCoord</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">xy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">2.0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> viewport</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">xy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">viewport</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">zw</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ndcPos</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">z</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">2.0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> gl_FragCoord</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">z</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> gl_DepthRange</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">near</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> gl_DepthRange</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">far</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gl_DepthRange</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">far</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> gl_DepthRange</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">near</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ndcPos</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">w</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vec4 clipPos </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ndcPos </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"> gl_FragCoord</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">w</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">vec4 eyePos </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> projectionMatrixInverse </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> clipPos</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>根据上面视口变换的公式，我们就可以反推出来 NDC 空间的坐标值，然后手动将 NDC 乘 <code>clip.w</code> 转换到裁剪空间，再通过逆投影矩阵转换到眼空间，我们还可以接着用逆矩阵转换到世界空间。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="渲染多个立方体"></a>渲染多个立方体<a class="hash-link" href="#渲染多个立方体" title="Direct link to heading">#</a></h2><p>现在让我们来用 MVP 矩阵来渲染多个立方体吧。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> gl </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">createGl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> program </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">createProgramFromSource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token template-string string" style="color:rgb(195, 232, 141)"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token template-string string" style="color:rgb(195, 232, 141)">attribute vec4 position;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token template-string string" style="color:rgb(195, 232, 141)">uniform mat4 model;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token template-string string" style="color:rgb(195, 232, 141)">uniform mat4 view;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token template-string string" style="color:rgb(195, 232, 141)">uniform mat4 projection;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token template-string string" style="display:inline-block;color:rgb(195, 232, 141)">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token template-string string" style="color:rgb(195, 232, 141)">void main() {</span></span><span class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token template-string string" style="color:rgb(195, 232, 141)">  gl_Position = projection * view * model * position;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token template-string string" style="color:rgb(195, 232, 141)">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token template-string string" style="color:rgb(195, 232, 141)"></span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token template-string string" style="color:rgb(195, 232, 141)"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token template-string string" style="color:rgb(195, 232, 141)">precision highp float;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token template-string string" style="display:inline-block;color:rgb(195, 232, 141)">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token template-string string" style="color:rgb(195, 232, 141)">void main() {</span></span><span class="token-line" style="color:#bfc7d5"><span class="token template-string string" style="color:rgb(195, 232, 141)">  gl_FragColor = vec4(gl_FragCoord.zzz, 1);</span></span><span class="token-line" style="color:#bfc7d5"><span class="token template-string string" style="color:rgb(195, 232, 141)">}</span></span><span class="token-line" style="color:#bfc7d5"><span class="token template-string string" style="color:rgb(195, 232, 141)"></span><span class="token template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> box </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">createBox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// { index: { value: [], size: 1 }, position: { value: [], size: 3 } }</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> indexBuffer </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">createBuffer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">bindBuffer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">ELEMENT_ARRAY_BUFFER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> indexBuffer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">bufferData</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">ELEMENT_ARRAY_BUFFER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> box</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">STATIC_DRAW</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">posLoc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">createAttrBuffer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;position&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> box</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">position</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">vertexAttribPointer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">posLoc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">FLOAT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">enableVertexAttribArray</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">posLoc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> camera </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Camera</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">camera</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">position</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">x</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> camera</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">position</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">y</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">camera</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">position</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">z</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">camera</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">lookAt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> viewLoc </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getUniformLocation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;view&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">uniformMatrix4fv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">viewLoc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> camera</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">viewMatrix</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> perLoc </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getUniformLocation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;projection&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">uniformMatrix4fv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">perLoc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token maybe-class-name">Mat4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">perspective</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">45</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Math</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">PI</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">180</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">canvas</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">clientWidth</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">canvas</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">clientHeight</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> modelLoc </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getUniformLocation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;model&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">enable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">DEPTH_TEST</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">enable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">CULL_FACE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">clearColor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> r </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">render</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">render</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">clear</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">COLOR_BUFFER_BIT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">DEPTH_BUFFER_BIT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> rotation </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token maybe-class-name">Mat4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">fromYRotation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">r</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">drawBox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> rotation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">drawBox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> rotation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">drawBox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> rotation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">drawBox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> rotation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">drawBox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> rotation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">drawBox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> rotation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  r </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.01</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">requestAnimationFrame</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">render</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">drawBox</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">x</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> y</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> z</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> rotation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">uniformMatrix4fv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">modelLoc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token maybe-class-name">Mat4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">multiply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">rotation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token maybe-class-name">Mat4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">fromTranslation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> z</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">drawElements</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">TRIANGLES</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> box</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">UNSIGNED_SHORT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">createShader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">gl</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> type</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> shader </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">createShader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">shaderSource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">shader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> source</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">compileShader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">shader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> shader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">createProgramFromSource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">gl</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> vertex</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> fragment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> vertexShader </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">createShader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">VERTEX_SHADER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">vertex</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> fragmentShader </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">createShader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">FRAGMENT_SHADER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> fragment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> program </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">createProgram</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">attachShader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> vertexShader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">attachShader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> fragmentShader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">linkProgram</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">useProgram</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> program</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">createAttrBuffer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">gl</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> program</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> attr</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token dom variable" style="color:rgb(191, 199, 213)">location</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getAttribLocation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">program</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> attr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> buffer </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">createBuffer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">bindBuffer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">ARRAY_BUFFER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">bufferData</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">ARRAY_BUFFER</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> gl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">STATIC_DRAW</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token dom variable" style="color:rgb(191, 199, 213)">location</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> buffer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><iframe style="border:0;width:100%;min-width:350px;height:350px"></iframe></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/10-coordinate-space.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/learn-webgl/docs/projection"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 投影矩阵</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/learn-webgl/docs/pre-sample"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">逐采样处理 »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#对象空间" class="table-of-contents__link">对象空间</a></li><li><a href="#世界空间" class="table-of-contents__link">世界空间</a></li><li><a href="#相机空间" class="table-of-contents__link">相机空间</a></li><li><a href="#裁剪空间" class="table-of-contents__link">裁剪空间</a></li><li><a href="#ndc-空间" class="table-of-contents__link">NDC 空间</a></li><li><a href="#渲染管线" class="table-of-contents__link">渲染管线</a></li><li><a href="#gl_fragcoord" class="table-of-contents__link">gl_FragCoord</a></li><li><a href="#渲染多个立方体" class="table-of-contents__link">渲染多个立方体</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/learn-webgl/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/woopen/learn-webgl" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 <a target="_blank" rel="noopener noreferrer" href="https://github.com/woopen">wopen</a></div></div></div></footer></div>
<script src="/learn-webgl/assets/js/runtime~main.4016e30c.js"></script>
<script src="/learn-webgl/assets/js/main.3b67555e.js"></script>
</body>
</html>